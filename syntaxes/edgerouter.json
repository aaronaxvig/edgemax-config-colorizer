{
  "name": "EdgeRouter",
  "fileTypes": ["edgerouter"],
  "scopeName": "text.edgerouter",
  "patterns": [
    {"include":"#firewall"},
    {"include":"#interfaces"},
    {"include":"#portforward"},
    {"include":"#protocols"},
    {"include":"#service"},
    {"include":"#system"}
  ],
  "repository":{
    "firewall":{
      "patterns":[
        {
          "begin":"(firewall\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#firewall-group"},
            {"include":"#firewall-name"},
            {
              "match":"((?:all-ping|broadcast-ping|ipv6-receive-redirects|ipv6-src-route|ip-src-route|log-martians|receive-redirects|send-redirects|source-validation|syn-cookies)\\s)(enable|disable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-group":{
      "patterns":[
        {
          "begin":"(group)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#firewall-group-networkgroup"}
          ]
        }
      ]
    },
    "firewall-group-networkgroup":{
      "patterns":[
        {
          "begin":"(network-group)\\s(.+)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#line-network-with-subnet"}
          ]
        }
      ]
    },
    "firewall-name":{
      "patterns":[
        {
          "begin":"(name|modify)\\s(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#firewall-name-rule"},
            {"include":"#line-description"},
            {
              "match":"(default-action\\s)(accept|drop|accept)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(enable-default-drop)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"}
              }
            },
            {
              "match":"(enable-default-log)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-name-rule":{
      "patterns":[
        {
          "begin":"(rule\\s)((?:[1-9][0-9]{3}|[1-9][0-9]{2}|[1-9][0-9]|[1-9])\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#firewall-name-rule-destination"},
            {"include":"#firewall-name-rule-modify"},
            {"include":"#firewall-name-rule-source"},
            {"include":"#firewall-name-rule-state"},
            {"include":"#line-description"},
            {"include":"#line-protocol"},
            {
              "match":"(action\\s)(accept|drop|modify)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(log\\s)(disable|enable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(protocol\\s)(all)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-name-rule-destination":{
      "patterns":[
        {
          "begin":"(destination)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#firewall-name-rule-destination-group"},
            {"include":"#line-address-with-subnet"}
          ]
        }
      ]
    },
    "firewall-name-rule-destination-group":{
      "patterns":[
        {
          "begin":"(group)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"(address-group)\\s(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(network-group)\\s(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-name-rule-modify":{
      "patterns":[
        {
          "begin":"(modify)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"(lb-group)\\s(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(table)\\s(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-name-rule-source":{
      "patterns":[
        {
          "begin":"(source\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#firewall-name-rule-source-group"},
            {"include":"#line-address-with-subnet"}
          ]
        }
      ]
    },
    "firewall-name-rule-source-group":{
      "patterns":[
        {
          "begin":"(group\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"(address-group\\s)(.*)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-name-rule-state":{
      "patterns":[
        {
          "begin":"(state)\\s(\\{)\\s*$",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"(established)\\s(disable|enable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(invalid)\\s(disable|enable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(new)\\s(disable|enable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(related)\\s(disable|enable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces":{
      "patterns":[
        {
          "begin":"(interfaces\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#interfaces-ethernet"},
            {"include":"#interfaces-loopback"},
            {"include":"#interfaces-switch"}
          ]
        }
      ]
    },
    "interfaces-ethernet":{
      "patterns":[
        {
          "begin":"(ethernet\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(address)\\s(dhcp|dhcpv6)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {"include":"#line-address-with-subnet"},
            {"include":"#line-description"},
            {"include":"#interfaces-ethernet-firewall"},
            {"include":"#interfaces-ethernet-poe"},
            {"include":"#interfaces-ethernet-vif"},
            {
              "match":"(duplex\\s)(auto|full|half)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(speed\\s)(10|100|auto)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces-ethernet-firewall":{
      "patterns":[
        {
          "begin":"(firewall\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#interfaces-ethernet-firewall-in"},
            {"include":"#interfaces-ethernet-firewall-local"},
            {"include":"#interfaces-ethernet-firewall-out"}
          ]
        }
      ]
    },
    "interfaces-ethernet-firewall-in":{
      "patterns":[
        {
          "begin":"(in\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-name"}
          ]
        }
      ]
    },
    "interfaces-ethernet-firewall-local":{
      "patterns":[
        {
          "begin":"(local\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-name"}
          ]
        }
      ]
    },
    "interfaces-ethernet-firewall-out":{
      "patterns":[
        {
          "begin":"(out\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-name"}
          ]
        }
      ]
    },
    "interfaces-ethernet-poe":{
      "patterns":[
        {
          "begin":"(poe\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(output\\s)(24v|off)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces-ethernet-vif":{
      "patterns":[
        {
          "begin":"(vif\\s)((?:0|([1-9]\\d{0,3}))?\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-description"},
            {"include":"#line-address-with-subnet"},
            {
              "match":"(mtu\\s)((?:0|([1-9]\\d{0,3}))?\\s)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.numeric.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces-loopback":{
      "patterns":[
        {
          "begin":"(loopback\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          }
        }
      ]
    },
    "interfaces-switch":{
      "patterns":[
        {
          "begin":"(switch\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#interfaces-switch-switchport"},
            {"include":"#line-description"}
          ]
        }
      ]
    },
    "interfaces-switch-switchport":{
      "patterns":[
        {
          "begin":"(switch-port\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#interfaces-switch-switchport-interface"},
            {
              "match":"(vlan-aware)\\s(disable|enable)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces-switch-switchport-interface":{
      "patterns":[
        {
          "begin":"(interface\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#interfaces-switch-switchport-interface-vlan"}
          ]
        }
      ]
    },
    "interfaces-switch-switchport-interface-vlan":{
      "patterns":[
        {
          "begin":"(vlan\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(pvid|vid)\\s(\\d+)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.numeric.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "line-address-with-subnet":{
      "patterns":[
        {
          "begin":"(address)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4-with-subnet"
            }
          ]
        }
      ]
    },
    "line-defaultrouter-address":{
      "patterns":[
        {
          "begin":"(default-router)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-description":{
      "patterns":[
        {
          "match":"(description\\s)(\")(.*)(\")",
          "captures":{
            "1":{"name":"keyword.other.edgemax"},
            "2":{"name":"constant.language.edgemax"},
            "3":{"name":"string.quoted.double.edgemax"},
            "4":{"name":"constant.language.edgemax"}
          }
        },
        {
          "match":"(description\\s)(.*)",
          "captures":{
            "1":{"name":"keyword.other.edgemax"},
            "2":{"name":"string.unquoted.edgemax"}
          }
        }
      ]
    },
    "line-dnsserver-address":{
      "patterns":[
        {
          "begin":"(dns-server)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-gatewayaddress-address":{
      "patterns":[
        {
          "begin":"(gateway-address)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-name":{
      "patterns":[
        {
          "match":"(name)\\s(.+)$",
          "captures":{
            "1":{"name":"keyword.other.edgemax"},
            "2":{"name":"string.unquoted.edgemax"}
          }
        }
      ]
    },
    "line-nameserver-address":{
      "patterns":[
        {
          "begin":"(name-server)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-network-with-subnet":{
      "patterns":[
        {
          "begin":"(network)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4-with-subnet"
            }
          ]
        }
      ]
    },
    "line-protocol":{
      "patterns":[
        {
          "match":"(protocol)\\s(.+)$",
          "captures":{
            "1":{"name":"keyword.other.edgemax"},
            "2":{"name":"string.unquoted.edgemax"}
          }
        }
      ]
    },
    "line-routerid-address":{
      "patterns":[
        {
          "begin":"(router-id)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-server-address":{
      "patterns":[
        {
          "begin":"(server)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-stop-address":{
      "patterns":[
        {
          "begin":"(stop)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-unificontroller-address":{
      "patterns":[
        {
          "begin":"(unifi-controller)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "part-address-ipv4":{
      "patterns":[
        {
          "match":"(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$",
          "name":"constant.numeric.edgemax"
        }
      ]
    },
    "part-address-ipv4-with-subnet":{
      "patterns":[
        {
          "match":"(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))\\s*$",
          "name":"constant.numeric.edgemax"
        }
      ]
    },
    "portforward":{
      "patterns":[
        {
          "begin":"(port-forward\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"((?:auto-firewall|hairpin-nat)\\s)(enable|disable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"((?:lan-interface|wan-interface)\\s)(\\w+\\s)",
              "captures":{
                "1":{"name":"support.class.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "protocols":{
      "patterns":[
        {
          "begin":"(protocols\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#protocols-ospf"},
            {"include":"#protocols-static"}
          ]
        }
      ]
    },
    "protocols-ospf":{
      "patterns":[
        {
          "begin":"(ospf\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#protocols-ospf-area"},
            {"include":"#protocols-ospf-parameters"},
            {"include":"#protocols-ospf-redistribute"}
          ]
        }
      ]
    },
    "protocols-ospf-area":{
      "patterns":[
        {
          "begin":"(area\\s)((?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#line-network-with-subnet"},
            {"include":"#protocols-ospf-area-areatype"}
          ]
        }
      ]
    },
    "protocols-ospf-area-areatype":{
      "patterns":[
        {
          "begin":"(area-type\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"normal",
              "name":"keyword.other.edgemax"
            }
          ]
        }
      ]
    },
    "protocols-ospf-parameters":{
      "patterns":[
        {
          "begin":"(parameters\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#line-routerid-address"},
            {
              "match":"(abr-type\\s)(cisco)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "protocols-ospf-redistribute":{
      "patterns":[
        {
          "begin":"(redistribute\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#protocols-ospf-redistribute-connected"}
          ]
        }
      ]
    },
    "protocols-ospf-redistribute-connected":{
      "patterns":[
        {
          "begin":"(connected\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"(metric-type\\s)(\\d)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.numeric.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "protocols-static":{
      "patterns":[
        {
          "begin":"(static\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[]
        }
      ]
    },
    "service":{
      "patterns":[
        {
          "begin":"(service\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#service-dhcprelay"},
            {"include":"#service-dhcpserver"},
            {"include":"#service-dns"},
            {"include":"#service-gui"},
            {"include":"#service-nat"},
            {"include":"#service-snmp"},
            {"include":"#service-ssh"}
          ]
        }
      ]
    },
    "service-dhcprelay":{
      "patterns":[
        {
          "begin":"(dhcp-relay\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-server-address"},
            {
              "match":"(interface\\s)(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-dhcpserver":{
      "patterns":[
        {
          "begin":"(dhcp-server)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#service-dhcpserver-sharednetworkname"},
            {
              "match":"(disabled)\\s(false)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(dynamic-dns-update)\\s(enable)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(global-parameters)\\s(.+)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(hostfile-update)\\s(disable|enable)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(use-dnsmasq)\\s(disable|enable)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-dhcpserver-sharednetworkname":{
      "patterns":[
        {
          "begin":"(shared-network-name)\\s(.+)\\s(\\{)$",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-description"},
            {"include":"#service-dhcpserver-sharednetworkname-subnet"},
            {
              "match":"(authoritative)\\s(enable)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(disable)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"}
              }
            },
            {
              "match":"(shared-network-parameters)\\s(.+)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-dhcpserver-sharednetworkname-subnet":{
      "patterns":[
        {
          "begin":"(subnet)\\s((?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(?:\\/(?:[0-9]|[1-2][0-9]|3[0-2])))\\s(\\{)$",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-defaultrouter-address"},
            {"include":"#line-dnsserver-address"},
            {"include":"#line-unificontroller-address"},
            {"include":"#service-dhcpserver-sharednetworkname-subnet-start"},
            {
              "match":"(lease)\\s(\\d+)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.numeric.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-dhcpserver-sharednetworkname-subnet-start":{
      "patterns":[
        {
          "begin":"(start)\\s((?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\\s(\\{)$",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-stop-address"}
          ]
        }
      ]
    },
    "service-dns":{
      "patterns":[
        {
          "begin":"(dns)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#service-dns-forwarding"}
          ]
        }
      ]
    },
    "service-dns-forwarding":{
      "patterns":[
        {
          "begin":"(forwarding)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(cache-size)\\s(\\d+)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.numeric.edgemax"}
              }
            },
            {
              "match":"(listen-on)\\s(.+)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-gui":{
      "patterns":[
        {
          "begin":"(gui\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"((?:http-port|https-port)\\s)([0-9]+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-nat":{
      "patterns":[
        {
          "begin":"(nat)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#service-nat-rule"}
          ]
        }
      ]
    },
    "service-nat-rule":{
      "patterns":[
        {
          "begin":"(rule)\\s(\\d+)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-description"},
            {"include":"#line-protocol"},
            {
              "match":"(log)\\s(enable|disable)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(outbound-interface)\\s(.+)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(type)\\s(destination|masquerade|source)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-snmp":{
      "patterns":[
        {
          "begin":"(snmp\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#service-snmp-community"}
          ]
        }
      ]
    },
    "service-snmp-community":{
      "patterns":[
        {
          "begin":"(community\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(authorization\\s)(ro|rw)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-ssh":{
      "patterns":[
        {
          "begin":"(ssh\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(port\\s)([0-9]+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(protocol-version\\s)(all|v1|v2)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "system":{
      "patterns":[
        {
          "begin":"(system\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-gatewayaddress-address"},
            {"include":"#line-nameserver-address"},
            {"include":"#system-login"},
            {"include":"#system-ntp"},
            {"include":"#system-syslog"},
            {
              "match":"(domain-name|host-name)\\s(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(domain-name|host-name)\\s(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(time-zone)\\s(.+)$",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "system-login":{
      "patterns":[
        {
          "begin":"(login\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#system-login-user"}
          ]
        }
      ]
    },
    "system-login-user":{
      "patterns":[
        {
          "begin":"(user\\s)(.+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#system-login-user-authentication"},
            {
              "match":"(full-name\\s)(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(level\\s)(admin|operator)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "system-login-user-authentication":{
      "patterns":[
        {
          "begin":"(authentication\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(encrypted-password\\s)(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(plaintext-password\\s)(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "system-ntp":{
      "patterns":[
        {
          "begin":"(ntp\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#system-ntp-server"}
          ]
        }
      ]
    },
    "system-ntp-server":{
      "patterns":[
        {
          "begin":"(server\\s)(.+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          }
        }
      ]
    },
    "system-syslog":{
      "patterns":[
        {
          "begin":"(syslog\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#system-syslog-global"}
          ]
        }
      ]
    },
    "system-syslog-global":{
      "patterns":[
        {
          "begin":"(global\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#system-syslog-global-facility"}
          ]
        }
      ]
    },
    "system-syslog-global-facility":{
      "patterns":[
        {
          "begin":"(facility\\s)(all|auth|authpriv|cron|daemon|kern|local0|local1|local2|local3|local4|local5|local6|local7|lpr|mail|mark|news|protocols|security|syslog|user|uucp)\\s(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.language.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(level\\s)(alert|crit|debug|emerg|err|info|notice|warning)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    }
  }
}