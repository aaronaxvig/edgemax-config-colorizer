{
  "name": "EdgeRouter",
  "fileTypes": ["edgerouter"],
  "scopeName": "text.edgerouter",
  "patterns": [
    {"include":"#firewall"},
    {"include":"#interfaces"},
    {"include":"#portforward"},
    {"include":"#protocols"},
    {"include":"#service"}
  ],
  "repository":{
    "firewall":{
      "patterns":[
        {
          "begin":"(firewall\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "include":"#firewall-ruleset"
            },
            {
              "match":"((?:all-ping|broadcast-ping|ipv6-receive-redirects|ipv6-src-route|ip-src-route|log-martians|receive-redirects|send-redirects|source-validation|syn-cookies)\\s)(enable|disable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-ruleset":{
      "patterns":[
        {
          "begin":"(name\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#firewall-ruleset-rule"},
            {"include":"#line-description"},
            {
              "match":"(default-action\\s)(accept|drop|accept)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-ruleset-rule":{
      "patterns":[
        {
          "begin":"(rule\\s)((?:[1-9][0-9]{3}|[1-9][0-9]{2}|[1-9][0-9]|[1-9])\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#firewall-ruleset-rule-source"},
            {"include":"#line-description"},
            {
              "match":"(action\\s)(accept|drop|accept)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(log\\s)(disable|enable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(protocol\\s)(all)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-ruleset-rule-source":{
      "patterns":[
        {
          "begin":"(source\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "include":"#firewall-ruleset-rule-source-group"
            }
          ]
        }
      ]
    },
    "firewall-ruleset-rule-source-group":{
      "patterns":[
        {
          "begin":"(group\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"(address-group\\s)(.*)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces":{
      "patterns":[
        {
          "begin":"(interfaces\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#interfaces-ethernet"},
            {"include":"#interfaces-loopback"}
          ]
        }
      ]
    },
    "interfaces-ethernet":{
      "patterns":[
        {
          "begin":"(ethernet\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-address-with-subnet"},
            {"include":"#line-description"},
            {"include":"#interfaces-ethernet-firewall"},
            {"include":"#interfaces-ethernet-poe"},
            {"include":"#interfaces-ethernet-vif"},
            {
              "match":"(duplex\\s)(auto|full|half)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(speed\\s)(10|100|auto)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces-ethernet-firewall":{
      "patterns":[
        {
          "begin":"(firewall\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#interfaces-ethernet-firewall-in"},
            {"include":"#interfaces-ethernet-firewall-local"}
          ]
        }
      ]
    },
    "interfaces-ethernet-firewall-in":{
      "patterns":[
        {
          "begin":"(in\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          }
        }
      ]
    },
    "interfaces-ethernet-firewall-local":{
      "patterns":[
        {
          "begin":"(local\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          }
        }
      ]
    },
    "interfaces-ethernet-poe":{
      "patterns":[
        {
          "begin":"(poe\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(output\\s)(24v|off)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces-ethernet-vif":{
      "patterns":[
        {
          "begin":"(vif\\s)((?:0|([1-9]\\d{0,3}))?\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-description"},
            {"include":"#line-address-with-subnet"},
            {
              "match":"(mtu\\s)((?:0|([1-9]\\d{0,3}))?\\s)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.numeric.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "interfaces-loopback":{
      "patterns":[
        {
          "begin":"(loopback\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          }
        }
      ]
    },
    "line-address-with-subnet":{
      "patterns":[
        {
          "begin":"(address)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4-with-subnet"
            }
          ]
        }
      ]
    },
    "line-network-with-subnet":{
      "patterns":[
        {
          "begin":"(network)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4-with-subnet"
            }
          ]
        }
      ]
    },
    "line-routerid-address":{
      "patterns":[
        {
          "begin":"(router-id)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-server-address":{
      "patterns":[
        {
          "begin":"(server)\\s",
          "beginCaptures":{
            "1":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#part-address-ipv4"
            }
          ]
        }
      ]
    },
    "line-description":{
      "patterns":[
        {
          "match":"(description\\s)(\")(.*)(\")",
          "captures":{
            "1":{"name":"keyword.other.edgemax"},
            "2":{"name":"constant.language.edgemax"},
            "3":{"name":"string.quoted.double.edgemax"},
            "4":{"name":"constant.language.edgemax"}
          }
        },
        {
          "match":"(description\\s)(.*)",
          "captures":{
            "1":{"name":"keyword.other.edgemax"},
            "2":{"name":"string.unquoted.edgemax"}
          }
        }
      ]
    },
    "part-address-ipv4":{
      "patterns":[
        {
          "match":"(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$",
          "name":"constant.numeric.edgemax"
        }
      ]
    },
    "part-address-ipv4-with-subnet":{
      "patterns":[
        {
          "match":"(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))$",
          "name":"constant.numeric.edgemax"
        }
      ]
    },
    "portforward":{
      "patterns":[
        {
          "begin":"(port-forward\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"((?:auto-firewall|hairpin-nat)\\s)(enable|disable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"((?:lan-interface|wan-interface)\\s)(\\w+\\s)",
              "captures":{
                "1":{"name":"support.class.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "protocols":{
      "patterns":[
        {
          "begin":"(protocols\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#protocols-ospf"},
            {"include":"#protocols-static"}
          ]
        }
      ]
    },
    "protocols-ospf":{
      "patterns":[
        {
          "begin":"(ospf\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#protocols-ospf-area"},
            {"include":"#protocols-ospf-parameters"},
            {"include":"#protocols-ospf-redistribute"}
          ]
        }
      ]
    },
    "protocols-ospf-area":{
      "patterns":[
        {
          "begin":"(area\\s)((?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#line-network-with-subnet"},
            {"include":"#protocols-ospf-area-areatype"}
          ]
        }
      ]
    },
    "protocols-ospf-area-areatype":{
      "patterns":[
        {
          "begin":"(area-type\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"normal",
              "name":"keyword.other.edgemax"
            }
          ]
        }
      ]
    },
    "protocols-ospf-parameters":{
      "patterns":[
        {
          "begin":"(parameters\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#line-routerid-address"},
            {
              "match":"(abr-type\\s)(cisco)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "protocols-ospf-redistribute":{
      "patterns":[
        {
          "begin":"(redistribute\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {"include":"#protocols-ospf-redistribute-connected"}
          ]
        }
      ]
    },
    "protocols-ospf-redistribute-connected":{
      "patterns":[
        {
          "begin":"(connected\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"(metric-type\\s)(\\d)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.numeric.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "protocols-static":{
      "patterns":[
        {
          "begin":"(static\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[]
        }
      ]
    },
    "service":{
      "patterns":[
        {
          "begin":"(service\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#service-dhcprelay"},
            {"include":"#service-gui"},
            {"include":"#service-snmp"},
            {"include":"#service-ssh"}
          ]
        }
      ]
    },
    "service-dhcprelay":{
      "patterns":[
        {
          "begin":"(dhcp-relay\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#line-server-address"},
            {
              "match":"(interface\\s)(.+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-gui":{
      "patterns":[
        {
          "begin":"(gui\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"((?:http-port|https-port)\\s)([0-9]+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-snmp":{
      "patterns":[
        {
          "begin":"(snmp\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {"include":"#service-snmp-community"}
          ]
        }
      ]
    },
    "service-snmp-community":{
      "patterns":[
        {
          "begin":"(community\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.unquoted.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(authorization\\s)(ro|rw)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "service-ssh":{
      "patterns":[
        {
          "begin":"(ssh\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "match":"(port\\s)([0-9]+)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            },
            {
              "match":"(protocol-version\\s)(all|v1|v2)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    }
  }
}