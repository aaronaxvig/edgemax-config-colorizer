{
  "name": "EdgeRouter",
  "fileTypes": ["edgerouter"],
  "scopeName": "text.edgerouter",
  "patterns": [
    {"include":"#firewall"}
  ],
  "patterns-old": [
    {"include":"#attribute-with-address"},
    {"include":"#attribute-with-address-with-subnet"},
    {"include":"#attribute-with-interface"},
    {"include":"#attribute-with-number"},
    {"include":"#attribute-with-string"},
    {"include":"#description"},
    {"include":"#keywords"},
    {"include":"#section"},
    {"include":"#section-with-address"},
    {"include":"#section-with-interface"},
    {"include":"#section-with-number"},
    {"include":"#section-with-string"},
    {"include":"#specials"}
  ],
  "repository":{
    "firewall":{
      "patterns":[
        {
          "begin":"(^firewall\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(^\\})",
          "endCaptures":{
            "1":{"name":"constant.numeric.edgemax"}
          },
          "patterns":[
            {
              "include":"#firewall-ruleset"
            },
            {
              "match":"((?:all-ping|broadcast-ping|ipv6-receive-redirects|ipv6-src-route|ip-src-route|log-martians|receive-redirects|send-redirects|source-validation|syn-cookies)\\s)(enable|disable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-ruleset":{
      "patterns":[
        {
          "begin":"(name\\s)(\\w+\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"string.quoted.double.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "include":"#firewall-ruleset-rule"
            },
            {
              "match":"(default-action\\s)(accept|drop|accept)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(description\\s)(\")(.*)(\")",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"},
                "3":{"name":"string.quoted.double.edgemax"},
                "4":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-ruleset-rule":{
      "patterns":[
        {
          "begin":"(rule\\s)((?:[1-9][0-9]{3}|[1-9][0-9]{2}|[1-9][0-9]|[1-9])\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.numeric.edgemax"},
            "3":{"name":"constant.character.edgemax"}
          },
          "end":"(\\s\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "include":"#firewall-ruleset-rule-source"
            },
            {
              "match":"(action\\s)(accept|drop|accept)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(description\\s)(\")(.*)(\")",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"},
                "3":{"name":"string.quoted.double.edgemax"},
                "4":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(log\\s)(disable|enable)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            },
            {
              "match":"(protocol\\s)(all)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"constant.language.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "firewall-ruleset-rule-source":{
      "patterns":[
        {
          "begin":"(source\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "include":"#firewall-ruleset-rule-source-group"
            }
          ]
        }
      ]
    },
    "firewall-ruleset-rule-source-group":{
      "patterns":[
        {
          "begin":"(group\\s)(\\{)",
          "beginCaptures":{
            "1":{"name":"support.class.edgemax"},
            "2":{"name":"constant.character.edgemax"}
          },
          "end":"(\\})",
          "endCaptures":{
            "1":{"name":"constant.character.edgemax"}
          },
          "patterns":[
            {
              "match":"(address-group\\s)(.*)",
              "captures":{
                "1":{"name":"keyword.other.edgemax"},
                "2":{"name":"string.unquoted.edgemax"}
              }
            }
          ]
        }
      ]
    },
    "address-ipv4":{
      "patterns":[
        {
          "match":"(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$",
          "name":"constant.numeric.edgemax"
        }
      ]
    },
    "address-ipv4-with-subnet":{
      "patterns":[
        {
          "match":"(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))$",
          "name":"constant.numeric.edgemax"
        }
      ]
    },
    "attribute-with-address":{
      "patterns":[
        {
          "begin":"^\\s*(router-id|server)\\s*",
          "beginCaptures":{
            "0":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#address-ipv4"
            }
          ]
        }
      ]
    },
    "attribute-with-address-with-subnet":{
      "patterns":[
        {
          "begin":"^\\s*(address|network)\\s",
          "beginCaptures":{
            "0":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#address-ipv4-with-subnet"
            }
          ]
        }
      ]
    },
    "attribute-with-interface":{
      "patterns":[
        {
          "begin":"^\\s*(interface|lan-interface|wan-interface)\\s",
          "beginCaptures":{
            "0":{"name":"keyword.other.edgemax"}
          },
          "end":"$",
          "patterns":[
            {
              "include":"#interface-id"
            }
          ]
        }
      ]
    },
    "attribute-with-number":{
      "patterns":[
        {
          "begin":"^\\s*(https-port|metric-type|mtu|port)\\s",
          "beginCaptures":{
            "0":{"name":"keyword.other.edgemax"}
          },
          "end":"[0-9]+\\s*$",
          "endCaptures":{
            "0":{"name":"constant.numeric.edgemax"}
          }
        }
      ]
    },
    "attribute-with-string":{
      "patterns":[
        {
          "begin":"^\\s*(abr-type|authorization|encrypted-password|full-name|host-name|level|plaintext-password|protocol-version|time-zone)\\s",
          "beginCaptures":{
            "0":{"name":"keyword.other.edgemax"}
          },
          "end":"[a-zA-Z0-9\\*]+\\s*$",
          "endCaptures":{
            "0":{"name":"string.quoted.double.edgemax"}
          }
        }
      ]
    },
    "description":{
      "patterns":[
        {
          "begin":"(address-group|description)",
          "beginCaptures":{
            "0":{"name":"keyword.other.edgemax"}
          },
          "end":"\\s*$",
          "patterns":[
            {
              "match":".*",
              "name":"string.quoted.double.edgemax"
            }
          ]
        }
      ]
    },
    "interface-id":{
      "patterns":[
        {
          "begin":"\\s*[a-z]*",
          "beginCaptures":{
            "0":{"name":"support.constant.type.interface.edgemax"}
          },
          "end":"([0-9]*[0-9\\.]*)",
          "endCaptures":{
            "0":{"name":"constant.numeric.interface-number.edgemax"}
          }
        }
      ]
    },
    "keywords":{
      "patterns":[
        {
          "match":"^\\s*abr-type\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*action\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*all-ping\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*auto-firewall\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*broadcast-ping\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*default-action\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*duplex\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*hairpin-nat\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*ip-src-route\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*ipv6-receive-redirects\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*ipv6-src-route\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*log\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*log-martians\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*protocol\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*receive-redirects\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*send-redirects\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*source-validation\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*speed\\s",
          "name":"keyword.other.edgemax"
        },
        {
          "match":"^\\s*syn-cookies\\s",
          "name":"keyword.other.edgemax"
        }
      ]
    },
    "section":{
      "patterns":[
        {
          "begin":"(^\\s*)(area\\-type|authentication|connected|dhcp-relay|firewall|global|group|gui|interfaces|local|login|ntp|ospf|parameters|port-forward|protocols|redistribute|service|snmp|source|ssh|static|syslog|system)",
          "beginCaptures":{
            "0":{"name":"support.class.edgemax"}
          },
          "end":"\\s*\\{\\s*$"
        }
      ]
    },
    "section-with-address":{
      "patterns":[
        {
          "begin":"^\\s*(area)\\s",
          "beginCaptures":{
            "0":{"name":"support.class.edgemax"}
          },
          "end":"\\s*\\{\\s*$",
          "patterns":[
            {
              "include":"#address-ipv4"
            }
          ]
        }
      ]
    },
    "section-with-interface":{
      "patterns":[
        {
          "begin":"^\\s*(ethernet|loopback)\\s",
          "beginCaptures":{
            "0":{"name":"support.class.edgemax"}
          },
          "end":"\\{",
          "patterns":[
            {
              "include":"#interface-id"
            }
          ]
        }
      ]
    },
    "section-with-number":{
      "patterns":[
        {
          "begin":"^\\s*(rule|vif)\\s",
          "beginCaptures":{
            "0":{"name":"support.class.edgemax"}
          },
          "end":"\\s*\\{\\s*$",
          "patterns":[
            {
              "match":"[0-9]+",
              "name":"constant.numeric.edgemax"
            }
          ]
        }
      ]
    },
    "section-with-string":{
      "patterns":[
        {
          "begin":"^\\s*(community|facility|name|server|user)\\s",
          "beginCaptures":{
            "0":{"name":"support.class.edgemax"}
          },
          "end":"\\s*\\{\\s*$",
          "patterns":[
            {
              "match":"[\\.\\w]+",
              "name":"string.quoted.double.edgemax"
            }
          ]
        }
      ]
    },
    "specials":{
      "patterns":[
        {
          "match": "all\\s*$",
          "name": "constant.language.edgemax"
        },
        {
          "match": "auto\\s*$",
          "name": "constant.language.edgemax"
        },
        {
          "match": "disable\\s*$",
          "name": "constant.language.edgemax"
        },
        {
          "match": "drop\\s*$",
          "name": "constant.language.edgemax"
        },
        {
          "match": "enable\\s*$",
          "name": "constant.language.edgemax"
        }
      ]
    }
  }
}